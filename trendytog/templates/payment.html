
{% extends 'base.html' %}
{% load static %}
{% block metadescription %}
   checkout$ payment page
{% endblock %}

{% block title %}
    checkout$payment
{% endblock %}

{% block content %}
   <div class="bg-light">
        <div class="container mt-5">
           <div class="card shadow p-4">
              <h2 class="text-center mb-4">Order Summary</h2>
              <table class="table table-bordered">
                <thead calss="table-secondary">
                    <tr>
                        <th> Product</th>
                        <th> Quantity</th>
                        <th> Price </th>
                        <th> Subtotal</th>
                    </tr> 
                    
                </thead>
                <tbody>
                    {% for item in cart_item %}
                    <tr>
                        <td>{{item.poduct.name}}</td>
                        <td>{{item.quantity}}</td>
                        <td>{{item.product.price}}</td>
                        <td>{{item.sub_total}}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            <h4 class="text-end mt-3">Total:${{total}}</h4>
            <div class="text-center mt-4">
                <button id="rzp-button1 " class="btn btn-success btn-lg">Pay${{total}}</button>

            </div>
        </div> 
    </div>
    <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
    <scripts>
        var options={
            "key":"{{razorpay_key}}",
            "amount":"{{payment.amount}}",
            "currency":"INR",
            "name":"My Django Store",
            "description":"purchase payment",
            "order_id":"{{payment.id}}",
            "handler":function(response){
                window.location.href="/cart/payment-success/?order_id={{order.id}}$payment_id="+response.razorpay_payment_id+"&signature="+esponse.razorpay_signature;
            },
            "prefill":{
                "name":"{{request.user.username}}",
                "email":"{{request.user.email}}"
            },
            "theme":{
                "color":"#528FF0"
            }

        };
        var rzp1 = new Razorpay(options);
        document.getElementById('rzp-button1').onclick=function(e){
            rzp1.open();
            e.preventDefault(),
        }

    </scripts>

     <div>
  
{% endblock%}
 
 
 
 
 {% comment %} <h2>5{{order.amount}}</h2>
 <script src=""https://checkout.razorpay.com/v1/checkout.js"></script>
 <<scripts>
      var options ={
          "key":"{{razorpay_key_id}}",
          "amount":"{{payment.amount}}",
          "currency":"INR",
          "name":"My Django store",
          "description":"order payment",
          "order_id":"{{payment.id}}",
          "callback_url":"{% url 'payment_success'%}",
          "prefil":{
       </       "name":"{{ request.user.username}}",
              "email":"{{ request.user.email }}"
          
        },
         "theme":{ 
                "color":"#3399cc"

         }
    };
    var rzp = new Razorpay(options);
    rzp.open();
  

 </scripts> {% endcomment %}